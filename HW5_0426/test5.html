<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>文具店購物車</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        h1 {
            text-align: center;
        }

        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        .add-to-cart {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
        }

        .add-to-cart:hover {
            background-color: #3e8e41;
        }

        .cart {
            position: fixed;
            top: 0;
            right: 0;
            background-color: #f1f1f1;
            padding: 20px;
            width: 300px;
            height: 100%;
            overflow: auto;
            border-left: 1px solid #ddd;
        }

        .cart h2 {
            margin-top: 0;
        }

        .cart ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        .cart li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        .cart img {
            max-width: 50px;
            height: auto;
            margin-right: 10px;
        }

        .quantity {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100px;
        }

        .quantity button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 5px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
        }

        .quantity button:hover {
            background-color: #3e8e41;
        }

        .quantity span {
            margin: 0 10px;
        }

        .total {
            font-weight: bold;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <h1>文具店</h1>
    <ul style="width: 70%;">
        <li>
            <img src="https://via.placeholder.com/150x150.png?text=Pen">
            <h3>筆</h3>
            <p>$10</p>
            <button class="add-to-cart" data-id="1" data-name="筆" data-price="5">加入購物車</button>
        </li>
        <li>
            <img src="https://via.placeholder.com/150x150.png?text=Pencil">
            <h3>鉛筆</h3>
            <p>$5</p>
            <button class="add-to-cart" data-id="2" data-name="鉛筆" data-price="15">加入購物車</button>
        </li>
        <li>
            <img src="https://via.placeholder.com/150x150.png?text=Eraser">
            <h3>橡皮擦</h3>
            <p>$2</p>
            <button class="add-to-cart" data-id="3" data-name="橡皮擦" data-price="20">加入購物車</button>
        </li>
    </ul>
    <div class="cart">
        <h2>購物車</h2>
        <ul class="cart-items">
            <li class="cart-header">
                <span>商品</span>
                <span>數量</span>
                <span>價格</span>
            </li>
        </ul>
        <div class="total-container">
            <span class="total-text">總計：</span>
            <span class="total"></span>
        </div>
    </div>
    <script>
        // 取得商品列表中的所有「加入購物車」按鈕
        const addToCartButtons = document.querySelectorAll('.add-to-cart');

        // 取得購物車中的所有商品項目
        const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];

        // 取得購物車列表和總金額顯示區域
        const cartList = document.querySelector('.cart-items');
        const cartTotal = document.querySelector('.total');

        // 更新購物車中的商品數量和總金額
        function updateCart() {
            // 清空購物車列表
            cartList.innerHTML = '';

            // 計算總金額
            let total = 0;
            for (const item of cartItems) {
                // 取得商品資訊
                const { id, name, price, quantity } = item;

                // 計算商品總價
                const itemTotal = price * quantity;

                // 新增商品項目到購物車列表
                const li = document.createElement('li');
                li.innerHTML = `
                    <span>${name}</span>
                    <span>${quantity}</span>
                    <span>$${itemTotal}</span>
                    <button class="increase" data-id="${id}">+</button>
                    <button class="decrease" data-id="${id}">-</button>
                    <button class="remove" data-id="${id}">x</button>
                `;
                cartList.appendChild(li);

                // 累加商品總價到總金額
                total += itemTotal;
            }

            // 更新總金額顯示
            cartTotal.textContent = `$${total}`;
            // 儲存購物車內容到 localStorage
            localStorage.setItem('cartItems', JSON.stringify(cartItems));
        }

        // 將商品加入購物車
        function addToCart(id, name, price) {
            // 檢查購物車是否已經有該商品，若有則增加數量，否則新增商品項目到購物車
            const existingItem = cartItems.find(item => item.id === id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cartItems.push({ id, name, price, quantity: 1 });
            }

            // 更新購物車內容
            updateCart();
        }

        // 將商品從購物車中移除
        function removeFromCart(id) {
            // 找出要移除的商品項目並刪除
            const index = cartItems.findIndex(item => item.id === id);
            if (index !== -1) {
                cartItems.splice(index, 1);
            }

            // 更新購物車內容
            updateCart();
        }

        // 增加商品數量
        function increaseQuantity(id) {
            // 找出要增加數量的商品項目並增加數量
            const item = cartItems.find(item => item.id === id);
            if (item) {
                item.quantity++;
            }

            // 更新購物車內容
            updateCart();
        }

        // 減少商品數量
        function decreaseQuantity(id) {
            // 找出要減少數量的商品項目並減少數量
            const item = cartItems.find(item => item.id === id);
            if (item && item.quantity > 1) {
                item.quantity--;
            }

            // 更新購物車內容
            updateCart();
        }

        // 監聽「加入購物車」按鈕的點擊事件
        for (const button of addToCartButtons) {
            button.addEventListener('click', event => {
                const id = event.target.dataset.id;
                const name = event.target.dataset.name;
                const price = event.target.dataset.price;
                addToCart(id, name, price);
            });
        }

        // 監聽購物車列表中的按鈕事件
        cartList.addEventListener('click', event => {
            const id = event.target.dataset.id;
            if (event.target.classList.contains('remove')) {
                removeFromCart(id);
            } else if (event.target.classList.contains('increase')) {
                increaseQuantity(id);
            } else if (event.target.classList.contains('decrease')) {
                decreaseQuantity(id);
            }
        });

        // 更新購物車內容
        updateCart();
    </script>
</body>

</html>